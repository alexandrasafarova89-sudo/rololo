<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>–†—É–ª–µ—Ç–∫–∞ NFT-–ø–æ–¥–∞—Ä–∫–æ–≤</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<style>
body { margin:0; font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background:linear-gradient(135deg,#1a1a2e,#16213e); color:#fff; text-align:center; overflow-x:hidden; padding:20px 10px; }
h1 { font-weight:700; font-size:24px; padding:10px 20px; border:2px solid rgba(255,255,255,0.2); border-radius:20px; display:inline-block; background:rgba(0,0,0,0.2); margin-bottom:20px; }
#nicknameContainer { margin-bottom:15px; }
#nicknameInput { padding:10px 15px; font-size:16px; border-radius:20px; border:none; width:70%; max-width:250px; margin-right:10px; }
#startBtn { padding:10px 20px; font-size:16px; border:none; border-radius:20px; background:linear-gradient(135deg,#ff3b3b,#ff6f61); cursor:pointer; color:#fff; }
#wheel-container { width:100%; max-width:720px; height:200px; margin:10px auto; overflow:hidden; border-radius:16px; background:linear-gradient(145deg,#1f1f1f,#111); position:relative; box-shadow:0 8px 24px rgba(0,0,0,0.5); display:none; }
#wheel { display:flex; transition: transform 0s linear; }
.prize { width:140px; height:200px; flex-shrink:0; margin:0 5px; background:#1b1b1b; border-radius:12px; display:flex; flex-direction:column; align-items:center; justify-content:center; border:2px solid #333; box-shadow:0 4px 12px rgba(0,0,0,0.4); transition: transform 0.3s ease, box-shadow 0.3s ease; }
.prize img { width:120px; height:120px; border-radius:6px; margin-bottom:6px; object-fit:contain; }
.prize.center { box-shadow:0 0 25px 6px #ffd700,0 0 40px 12px #ffea00 inset; animation: glowJump 1s infinite; }
@keyframes glowJump {0%,100%{transform:translateY(0) scale(1);}25%{transform:translateY(-5px) scale(1.05);}50%{transform:translateY(0) scale(1);}75%{transform:translateY(-3px) scale(1.03);}}
#arrow { position:absolute; top:0; left:50%; transform:translateX(-50%); width:3px; height:200px; background:#ff3b3b; z-index:10; }
#spinBtn { margin-top:20px; padding:15px 35px; font-size:18px; font-weight:600; border:none; border-radius:30px; cursor:pointer; background:linear-gradient(135deg,#ff3b3b,#ff6f61); color:#fff; box-shadow:0 6px 18px rgba(0,0,0,0.4); transition:all 0.3s ease; display:none; }
#spinBtn:hover{transform:scale(1.05);}
#result { margin-top:15px; font-size:18px; font-weight:600; color:#ffd700; }
#getBtn { display:none; margin:10px auto 10px auto; padding:12px 30px; border:none; border-radius:25px; background:linear-gradient(135deg,#ffd700,#ffea00); color:#000; font-weight:700; cursor:pointer; font-size:16px; }
#closeBtn { margin:10px auto 0 auto; padding:12px 30px; border:none; border-radius:25px; background:#333; color:#fff; font-weight:600; cursor:pointer; font-size:16px; display:block; }
#closeBtn:hover{background:#555;}
#onlineCounter { position:fixed; top:10px; left:10px; background:rgba(0,0,0,0.4); padding:6px 12px; border-radius:12px; font-size:14px; font-weight:600; }
#minibar { position:fixed; top:10px; right:10px; width:200px; max-width:40%; max-height:250px; overflow:hidden; background:rgba(0,0,0,0.3); border-radius:12px; padding:8px; font-size:12px; display:flex; flex-direction:column; justify-content:flex-start; }
.minibar-entry { margin-bottom:6px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
@media(max-width:480px){ #wheel-container{height:180px;} .prize{width:100px;height:160px;} .prize img{width:80px;height:80px;} #spinBtn{font-size:16px;padding:12px 25px;} #getBtn,#closeBtn{font-size:14px;padding:10px 20px;} h1{font-size:20px; padding:8px 16px;} #minibar{width:150px; font-size:10px;} }
</style>
</head>
<body>

<div id="onlineCounter">–û–Ω–ª–∞–π–Ω: 0</div>
<div id="minibar"></div>

<h1>üéÅ –†—É–ª–µ—Ç–∫–∞ NFT-–ø–æ–¥–∞—Ä–∫–æ–≤</h1>

<div id="nicknameContainer">
  <input id="nicknameInput" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –Ω–∏–∫">
  <button id="startBtn">–ù–∞—á–∞—Ç—å</button>
</div>

<div id="wheel-container">
  <div id="arrow"></div>
  <div id="wheel"></div>
</div>

<button id="spinBtn">–ö—Ä—É—Ç–∏—Ç—å —Ä—É–ª–µ—Ç–∫—É</button>
<div id="result"></div>
<button id="getBtn">–ü–æ–ª—É—á–∏—Ç—å –ø–æ–¥–∞—Ä–æ–∫</button>
<button id="closeBtn">–ó–∞–∫—Ä—ã—Ç—å</button>

<script src="https://telegram.org/js/telegram-web-app.js"></script>
<script>
const tg=window.Telegram.WebApp;
tg.expand();

const prizes=[
  { label:"Precious Peach", img:"https://i.imgur.com/2yRxnFO.jpeg", weight:2, cost:58297 },
  { label:"Nail Bracelet", img:"https://i.imgur.com/I0OTDPZ.jpeg", weight:3, cost:38432 },
  { label:"Astral Shard", img:"https://i.imgur.com/GfJhqte.jpeg", weight:4, cost:27992 },
  { label:"Loot Bag", img:"https://i.imgur.com/FWv82Jo.jpeg", weight:5, cost:13488 },
  { label:"Gem Signet", img:"https://i.imgur.com/GUVA6Ag.jpeg", weight:6, cost:15642 },
  { label:"Artisan Brick", img:"https://i.imgur.com/9cOITRi.jpeg", weight:7, cost:9992 },
  { label:"Signet Ring", img:"https://i.imgur.com/iX8ucHl.jpeg", weight:8, cost:8192 },
  { label:"–ë—Ä–∏–ª–ª–∏–∞–Ω—Ç", img:"https://i.imgur.com/fBU1h2j.jpeg", weight:15, cost:100 },
  { label:"–ö–æ–ª—å—Ü–æ", img:"https://i.imgur.com/IOY4GTw.jpeg", weight:15, cost:100 },
  { label:"–ö—É–±–æ–∫", img:"https://i.imgur.com/nLAgng1.jpeg", weight:15, cost:100 },
  { label:"–®–∞–º–ø–∞–Ω—Å–∫–æ–µ", img:"https://i.imgur.com/FfV5cNa.jpeg", weight:20, cost:50 },
  { label:"–ü–æ–¥–∞—Ä–æ—á–µ–∫", img:"https://i.imgur.com/1VPUHDT.jpeg", weight:25, cost:25 },
  { label:"–†–æ–∑–∞", img:"https://i.imgur.com/yDyzdsK.jpeg", weight:25, cost:25 },
  { label:"–ú–∏—à–∫–∞", img:"https://i.imgur.com/JbhoMQq.jpeg", weight:25, cost:15 },
  { label:"–°–µ—Ä–¥–µ—á–∫–æ", img:"https://i.imgur.com/h0rdv9c.jpeg", weight:25, cost:15 }
];

const nicknames=["–ê–Ω—é—Ç–∞","–ê–ª–∏—Å–∞","–ê–ª–µ–Ω–æ—á–∫–∞","–ú–∞—à—É–ª—å–∫–∞","DarkFantast","CryptoKing","LuckyStar","üéØSharpShooter","‚ú®MagicMan","üå∏FlowerGirl"];

const wheel=document.getElementById('wheel');
const spinBtn=document.getElementById('spinBtn');
const resultDiv=document.getElementById('result');
const getBtn=document.getElementById('getBtn');
const closeBtn=document.getElementById('closeBtn');
const onlineCounter=document.getElementById('onlineCounter');
const minibar=document.getElementById('minibar');

const nicknameInput=document.getElementById('nicknameInput');
const startBtn=document.getElementById('startBtn');
const wheelContainer=document.getElementById('wheel-container');
let userNick="";

// –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫–æ–ª–µ—Å–∞
const prizeSequence=[];
for(let i=0;i<20;i++) prizeSequence.push(...prizes);
prizeSequence.forEach(p=>{
  const div=document.createElement('div');
  div.className='prize';
  div.innerHTML=`<img src="${p.img}" alt="${p.label}"><div>${p.label}</div><div style="font-size:12px;color:#ccc;">${p.cost} ‚≠ê</div>`;
  wheel.appendChild(div);
});

// –û–Ω–ª–∞–π–Ω –ø–ª–∞–≤–Ω–æ –º–µ–Ω—è–µ—Ç—Å—è ¬±0-9 —á–µ–ª
let onlineCount=Math.floor(Math.random()*270)+300;
onlineCounter.textContent="–û–Ω–ª–∞–π–Ω: "+onlineCount;
setInterval(()=>{
  let delta=Math.floor(Math.random()*10);
  delta=Math.random()<0.5?-delta:delta;
  onlineCount=Math.max(300,Math.min(569,onlineCount+delta));
  onlineCounter.textContent="–û–Ω–ª–∞–π–Ω: "+onlineCount;
},2000);

// –ú–∏–Ω–∏-–±–∞—Ä –≤—ã–ø–∞–¥–µ–Ω–∏–π
function addMiniBarEntry(nick,prize){
  const div=document.createElement('div');
  div.className='minibar-entry';
  div.textContent=`${nick} –≤—ã–±–∏–ª ${prize.label} –∑–∞ ${prize.cost} ‚≠ê`;
  minibar.prepend(div);
  if(minibar.children.length>10) minibar.removeChild(minibar.lastChild);
}

// –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª—É—á–∞–π–Ω–æ–≥–æ –Ω–∏–∫–∞ —Å —ç–º–æ–¥–∑–∏
function randomNick(){ 
  const nick=nicknames[Math.floor(Math.random()*nicknames.length)];
  const emoji=Math.random()<0.5?["üéâ","üíé","‚ú®","üî•","üå∏"][Math.floor(Math.random()*5)]:"";
  return nick+" "+emoji;
}

// –°–ª—É—á–∞–π–Ω—ã–π –ø—Ä–∏–∑
function randomPrize(){ return prizes[Math.floor(Math.random()*prizes.length)]; }

// –§–µ–π–∫–æ–≤—ã–µ —Å–æ–±—ã—Ç–∏—è
setInterval(()=>{
  addMiniBarEntry(randomNick(),randomPrize());
},3000);

// –ù–∞—á–∞–ª–æ –∏–≥—Ä—ã –ø–æ—Å–ª–µ –≤–≤–æ–¥–∞ –Ω–∏–∫–∞
startBtn.addEventListener('click',()=>{
  const val=nicknameInput.value.trim();
  if(!val){alert("–í–≤–µ–¥–∏—Ç–µ –Ω–∏–∫!"); return;}
  userNick=val;
  document.getElementById('nicknameContainer').style.display='none';
  wheelContainer.style.display='block';
  spinBtn.style.display='inline-block';
});

// –ü—Ä–æ–∫—Ä—É—Ç–∫–∞ —Ä—É–ª–µ—Ç–∫–∏
spinBtn.addEventListener('click',()=>{
  const totalWeight=prizes.reduce((s,p)=>s+p.weight,0);
  let rand=Math.random()*totalWeight;
  let selectedIndex=0,cumulative=0;
  for(let i=0;i<prizes.length;i++){cumulative+=prizes[i].weight;if(rand<=cumulative){selectedIndex=i;break;}}

  const prizeWidth=140;
  const middle=Math.floor(prizeSequence.length/2);
  const targetIndex=middle*prizes.length+selectedIndex;
  const containerWidth=wheelContainer.offsetWidth;
  const targetOffset=targetIndex*prizeWidth-containerWidth/2+prizeWidth/2;

  let currentOffset=0;
  let speed=50+Math.random()*20;
  const deceleration=0.995;

  getBtn.style.display="none";
  resultDiv.textContent="";

  const animate=()=>{
    currentOffset+=speed;
    if(currentOffset>=targetOffset) currentOffset=targetOffset;
    wheel.style.transform=`translateX(-${currentOffset}px)`;

    const children=wheel.children;
    const wheelRect=wheelContainer.getBoundingClientRect();
    const center=wheelRect.left+wheelRect.width/2;
    let prizeAtCenter=null;

    for(let i=0;i<children.length;i++){
      const child=children[i];
      const rect=child.getBoundingClientRect();
      const diff=Math.abs(rect.left+rect.width/2-center);
      const scale=Math.max(0.7,1-diff/300);
      const yOffset=(1-scale)*30;
      child.style.transform=`scale(${scale}) translateY(${yOffset}px)`;
      if(diff<prizeWidth/2) prizeAtCenter=prizeSequence[i];
    }

    speed*=deceleration;
    if(speed>0.2 && currentOffset<targetOffset) requestAnimationFrame(animate);
    else{
      wheel.style.transform=`translateX(-${targetOffset}px)`;
      resultDiv.innerHTML=`üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –í—ã –≤—ã–∏–≥—Ä–∞–ª–∏ <b>${prizeAtCenter.label}</b> –∑–∞ <b>${prizeAtCenter.cost} ‚≠ê</b>!<br><img src="${prizeAtCenter.img}" style="max-height:100px;margin-top:5px;">`;
      getBtn.style.display="block";

      // –ó–≤—É–∫ –ø–æ–±–µ–¥—ã
      const winSound=new Audio("https://image2url.com/r2/default/audio/1769643999529-e3ec9dec-df5e-4b91-a2a4-e6982a82ab7e.mp3");
      winSound.volume=0.5;
      winSound.play();

      // –û—Ç–ø—Ä–∞–≤–∫–∞ –≤ –º–∏–Ω–∏-–±–∞—Ä –∏ –≤ —Ç–µ–ª–µ–≥—Ä–∞–º
      addMiniBarEntry(userNick,prizeAtCenter);
      tg.sendData(JSON.stringify({prize:prizeAtCenter.label,cost:prizeAtCenter.cost}));
    }
  };
  animate();
});

getBtn.addEventListener('click',()=>{ alert("–ß—Ç–æ–±—ã –∑–∞–±—Ä–∞—Ç—å –ø–æ–¥–∞—Ä–æ–∫ —Å–ª–µ–¥—É–π—Ç–µ –¥–∞–ª—å–Ω–µ–π—à–∏–º –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –≤ —Å–∞–º–æ–º –±–æ—Ç–µ!"); });
closeBtn.addEventListener('click',()=>tg.close());
</script>

</body>
</html>
